---
title: "Unit 11 activities"
author: "Guilherme Amorim"
date: "2024-10-16"
output: pdf_document
---

# Unit 11 - Notes 

## R

### Initial setup

```{r, include=T, message=F}
# initial setup
library(haven)
library(skimr)
library(tidyverse)
library(here)
```

### Data load
```{r}
load(here("Datasets/marketing.rda"))

write_csv(marketing, here("Datasets/marketing.csv"))

```

### Scatter plot and regression line (for youtube sales)

```{r}

marketing%>%
  ggplot(aes(youtube, sales))+
  geom_point()+
  stat_smooth()

```

The scatter plot indicates a linear relationship between both variables
### Correlation

```{r}
cor.test(marketing$youtube, marketing$sales)

```
From the correlation coefficient, we can say that there is a strong, positive, statistically significant association between budget spent on Youtube marketing and sales 

### Linear regression model


```{r}

model<-lm(sales~youtube, marketing)

model

summary(model)

```
The linear regression model can be expressed as: Sales = 8.43911 + 0.04754 * (Youtube). The p-values for both the intercept and the slope of the predictor variable are <0.001 and therefore statistically significant  (i.e. not generated by a random distribution of the underlying variables).
The residual standard error is 3.91, which provides a measure of the average absolute error associated with each prediction. 
The adjusted R-squared is 0.6099, indicating that 60% of the variance in the dependent variable (sales) is explained by the independent variable (Youtube marketing budget). This measure is quite similar to the crude R-squared as there is only one dependent variable.


## Python

### Initial setup


```{python}
# first install packages (from terminal)

# pip3 install numpy

# pip3 install pandas

# pip3 install matplotlib 

# pip3 install pyreadstat 

import pandas as pd

import numpy as np 

import matplotlib.pyplot as plt

from scipy import stats

import pyreadr

import sklearn 

from sklearn.linear_model import LinearRegression

```



### Data load

```{python}

data = pd.read_csv("C:/Users/guilhermep/Documents/PgDip/Coding/Module 2/pgdip_module2_practice/Datasets/marketing.csv")


```

### Scatter plot and regression line

```{python}

m, b = np.polyfit(data.youtube, data.sales, 1)

plt.scatter(data.youtube, data.sales, color="black")
plt.plot(data.youtube, m*data.youtube+b, color='red')
plt.xlabel("Youtube marketing budget")
plt.ylabel("Sales")
plt.show()

```
### Correlation

```{python}
stats.pearsonr(data.youtube, data.sales)

```

### Linear regression model

```{python}

x=np.array(data.youtube).reshape(-1, 1)

y=np.array(data.sales).reshape(-1, 1)

model = LinearRegression().fit(x, y)

r_sq = model.score(x, y)
print(f"intercept: {model.intercept_}")
print(f"slope: {model.coef_}")
print(f"R-squared: {r_sq}")
print(f"adjusted R-squared: {1 - ( 1-model.score(x, y) ) * ( len(y) - 1 ) / ( len(y) - x.shape[1] - 1 )}")
```




# Unit 11 - data activity

Using the Health_Data, please perform the following functions in R:

Perform simple linear regression analysis to find the population regression equation to predict the diastolic BP by systolic BP.
Interpret the findings of regression analysis at 5% level of significance.

## R

### load data

```{r}
data<-read_sav(here("Datasets/Health Data.sav"))


```

### linear regression model

```{r}

model<-lm(dbp~sbp, data)

model

summary(model)


```
The regression equation for dbp as a function of sbp is dbp = 19.4068 + 0.496*sbp.

The p-values for the intercept and the coefficient of the predictor variable are both <0.001, and are therefore highly statistically significant at the 0.05 significance level. Therefore, the null hypothesis of no significant association between the predictor (sbp) and outcome variables (dbp) and conclude that there is a statistically significant association between them.

## Python


### load data


```{python}
data = pd.read_spss("C:/Users/guilhermep/Documents/PgDip/Coding/Module 2/pgdip_module2_practice/Datasets/Health Data.sav")

```

### linear regression model


```{python}

x=np.array(data.sbp).reshape(-1, 1)

y=np.array(data.dbp).reshape(-1, 1)

model = LinearRegression().fit(x, y)

r_sq = model.score(x, y)
print(f"intercept: {model.intercept_}")
print(f"slope: {model.coef_}")
print(f"R-squared: {r_sq}")
print(f"adjusted R-squared: {1 - ( 1-model.score(x, y) ) * ( len(y) - 1 ) / ( len(y) - x.shape[1] - 1 )}")

```